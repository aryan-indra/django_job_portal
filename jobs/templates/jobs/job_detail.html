{% extends 'jobs/base.html' %}

{% block title %}Browse Jobs - Job Portal{% endblock %}

{% block content %}
<div class="bg-gray-100 py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Page Header -->
        <div class="mb-8 animate-fade-in">
            <h1 class="text-4xl font-bold text-gray-900 mb-2">Browse Job Opportunities</h1>
            <p class="text-gray-600">Find your next career move from {{ page_obj.paginator.count }} available positions</p>
        </div>
        
        <!-- Search and Filter Section -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8 animate-fade-in">
            <form method="GET" action="{% url 'job_list' %}" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Search Input -->
                    <div class="md:col-span-2">
                        <div class="relative">
                            <i class="fas fa-search absolute left-4 top-4 text-gray-400"></i>
                            <input type="text" name="search" value="{{ search_query }}" 
                                   placeholder="Search by title, company, or location..."
                                   class="w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                    </div>
                    
                    <!-- Job Type Filter -->
                    <div>
                        <select name="job_type" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                            <option value="">All Job Types</option>
                            <option value="FT" {% if job_type == 'FT' %}selected{% endif %}>Full Time</option>
                            <option value="PT" {% if job_type == 'PT' %}selected{% endif %}>Part Time</option>
                            <option value="CT" {% if job_type == 'CT' %}selected{% endif %}>Contract</option>
                            <option value="IN" {% if job_type == 'IN' %}selected{% endif %}>Internship</option>
                        </select>
                    </div>
                </div>
                
                <div class="flex gap-3">
                    <button type="submit" class="btn-primary text-white px-6 py-2 rounded-lg font-medium">
                        <i class="fas fa-filter mr-2"></i> Apply Filters
                    </button>
                    <a href="{% url 'job_list' %}" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-medium hover:bg-gray-300 transition">
                        <i class="fas fa-times mr-2"></i> Clear
                    </a>
                </div>
            </form>
        </div>
        
        <!-- Job Listings Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in">
            {% for job in page_obj %}
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover flex flex-col">
                <!-- Company Logo/Icon -->
                <div class="flex items-start justify-between mb-4">
                    <div class="w-14 h-14 gradient-bg rounded-xl flex items-center justify-center">
                        <i class="fas fa-building text-white text-xl"></i>
                    </div>
                    <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-xs font-semibold">
                        {{ job.get_job_type_display }}
                    </span>
                </div>
                
                <!-- Job Title and Company -->
                <h3 class="text-xl font-bold text-gray-900 mb-2 line-clamp-2">{{ job.title }}</h3>
                <p class="text-gray-600 font-medium mb-4">{{ job.company_name }}</p>
                
                <!-- Job Details -->
                <div class="space-y-2 mb-4 flex-grow">
                    <div class="flex items-center text-gray-500 text-sm">
                        <i class="fas fa-map-marker-alt w-5"></i>
                        <span>{{ job.location }}</span>
                    </div>
                    
                    {% if job.salary_range %}
                    <div class="flex items-center text-gray-500 text-sm">
                        <i class="fas fa-money-bill-wave w-5"></i>
                        <span>{{ job.salary_range }}</span>
                    </div>
                    {% endif %}
                    
                    <div class="flex items-center text-gray-500 text-sm">
                        <i class="far fa-clock w-5"></i>
                        <span>Posted {{ job.created_at|timesince }} ago</span>
                    </div>
                    
                    <div class="flex items-center text-gray-500 text-sm">
                        <i class="fas fa-users w-5"></i>
                        <span>{{ job.application_count }} applicant{{ job.application_count|pluralize }}</span>
                    </div>
                </div>
                
                <!-- Description Preview -->
                <p class="text-gray-600 text-sm mb-4 line-clamp-2">{{ job.description|truncatewords:20 }}</p>
                
                <!-- Action Button -->
                <div class="mt-auto pt-4 border-t">
                    <a href="{% url 'job_detail' job.id %}" class="block text-center btn-primary text-white py-2 rounded-lg font-medium">
                        View Details
                    </a>
                </div>
            </div>
            {% empty %}
            <div class="lg:col-span-3">
                <div class="bg-white rounded-xl shadow-lg p-12 text-center">
                    <i class="fas fa-search text-gray-400 text-6xl mb-4"></i>
                    <h3 class="text-2xl font-bold text-gray-900 mb-2">No Jobs Found</h3>
                    <p class="text-gray-600 mb-6">Try adjusting your search or filters to find what you're looking for.</p>
                    <a href="{% url 'job_list' %}" class="btn-primary text-white px-6 py-3 rounded-lg font-medium inline-block">
                        Clear Filters
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Pagination -->
        {% if page_obj.has_other_pages %}
        <div class="mt-12 flex justify-center">
            <nav class="bg-white rounded-lg shadow-lg px-4 py-3">
                <ul class="flex items-center space-x-2">
                    {% if page_obj.has_previous %}
                    <li>
                        <a href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}{% if job_type %}&job_type={{ job_type }}{% endif %}" 
                           class="px-3 py-2 text-gray-700 hover:bg-purple-50 rounded-lg transition">
                            <i class="fas fa-angle-double-left"></i>
                        </a>
                    </li>
                    <li>
                        <a href="?page={{ page_obj.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if job_type %}&job_type={{ job_type }}{% endif %}" 
                           class="px-3 py-2 text-gray-700 hover:bg-purple-50 rounded-lg transition">
                            <i class="fas fa-angle-left"></i>
                        </a>
                    </li>
                    {% endif %}
                    
                    <li class="px-4 py-2 text-gray-700 font-medium">
                        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
                    </li>
                    
                    {% if page_obj.has_next %}
                    <li>
                        <a href="?page={{ page_obj.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if job_type %}&job_type={{ job_type }}{% endif %}" 
                           class="px-3 py-2 text-gray-700 hover:bg-purple-50 rounded-lg transition">
                            <i class="fas fa-angle-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="?page={{ page_obj.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}{% if job_type %}&job_type={{ job_type }}{% endif %}" 
                           class="px-3 py-2 text-gray-700 hover:bg-purple-50 rounded-lg transition">
                            <i class="fas fa-angle-double-right"></i>
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </nav>
        </div>
        {% endif %}
    </div>
</div>

{% block extra_js %}
<style>
    .line-clamp-2 {
        display: -webkit-box;
        line-clamp:2;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>
{% endblock %}
{% endblock %}